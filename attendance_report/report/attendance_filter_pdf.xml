<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="custom_layout">
        <t t-if="not o" t-set="o" t-value="doc" />

        <t t-if="not company">
            <!-- Multicompany -->
            <t t-if="company_id">
                <t t-set="company" t-value="company_id" />
            </t>
            <t t-elif="o and 'company_id' in o and o.company_id.sudo()">
                <t t-set="company" t-value="o.company_id.sudo()" />
            </t>
            <t t-else="else">
                <t t-set="company" t-value="res_company" />
            </t>
        </t>
        <div class="header">
            <div class="row">
                <div class="col-4 mb-4">
                    <img t-if="company.logo" t-att-src="image_data_uri(company.logo)"
                        style="max-height:50px;" alt="Logo" />
                </div>
                <div class="col-8 mb-5" style="text-align:right">
                    <span style = "font-weight:700">
                        <t t-out = "company.name"/>
                    </span>
                <p><t t-out = "company.street"/>
                    <br/>
                    <t t-out = "company.city"/>
                    <br/>
                    <t t-out = "company.country_id.name"/>
                </p>
                    

                    <!-- <t t-raw="company.company_details" /> -->
                </div>
            </div>

        </div>
        <div class="article o_report_layout_standard">
            <t t-out="0" />
        </div>
        <div class="footer pt-5">
            <div class="row mt-2">
                <p class="text-center"> Page: <span class="page" /> / <span class="topage" />
                </p>
            </div>
        </div>
    </template>


    <template id="filter_records">

        <t t-call="web.html_container">
            <t t-call="attendance_report.custom_layout">
                <h2 style="font-size: 25px;">
                    <center><b>Personal Ledger</b></center>
                </h2>

                <t t-set="counter" t-value="0" />

                <tr t-foreach="extra['attendance_data']" t-as="line">
                    <t t-if="counter == 1">
                        <p style="page-break-before:always;"> </p>
                        <t t-set="counter" t-value="0" />
                    </t>
                    <t t-if="len(line)!=0">

                        <div class="page">

                            <span>
                                <tr>
                                    <td>
                                        <h5>
                                            <div class="row">
                                                <div class="col-4"> Employee: <t
                                                        t-esc="line['employee_id']" />
                                                </div>
                                                <div class="col-4"> From: <t
                                                        t-esc="extra['form_data']['from_date']" />
                                                </div>
                                                <div class="col-4"> To: <t
                                                        t-esc="extra['form_data']['to_date']" /><br />
                                                </div>
                                            </div>
                                        </h5>
                                    </td>
                                </tr>
                            </span>
                            <br />

                            <h5>Attendance Summary</h5>

                            <table class="table table-responsive" name="attendance_details_table">

                                <tr>
                                    <th class="text-center">
                                        <span>Total</span>
                                    </th>
                                    <th class="text-center">
                                        <span>Present</span>
                                    </th>
                                    <th class="text-center">
                                        <span>Absent</span>
                                    </th>
                                    <th class="text-center">
                                        <span>Leave</span>
                                    </th>
                                    <th class="text-center">
                                        <span>Holiday</span>
                                    </th>
                                    <th class="text-center">
                                        <span>Weekend</span>
                                    </th>

                                </tr>

                                <tbody class="summary_tbody">

                                    <t t-set="index" t-value="extra['attendance_data'].index(line)" />
                                    <t t-set="worked_hours_total" t-value="0" />

                                    <tr class="border-black">
                                        <td class="text-center">
                                            <t t-esc="extra['total']" />
                                        </td>
                                        <td class="text-center">
                                            <t t-esc="line['total_present']" />
                                        </td>
                                        <td class="text-center">
                                            <t t-esc="line['total_absent']" />
                                        </td>
                                        <td class="text-center">
                                            <t t-esc="line['total_leave']" />
                                        </td>
                                        <td class="text-center">
                                            <t t-esc="line['total_holiday']" />
                                        </td>
                                        <td class="text-center">
                                            <t t-esc="line['total_weekend']" />
                                        </td>
                                    </tr>

                                </tbody>

                            </table>

                            <h5>Attendance Details</h5>

                            <table class="table" name="attendance_details_table">

                                <tr>
                                    <th class="text-center">
                                        <span>Date</span>
                                    </th>
                                    <th class="text-center">
                                        <span>Day</span>
                                    </th>

                                    <th class="text-center">
                                        <span>Check-in</span>
                                    </th>
                                    <th class="text-center">
                                        <span>Check-out</span>
                                    </th>

                                    <th class="text-center">
                                        <span>Worked Hours</span>
                                    </th>
                                    <th class="text-center">
                                        <span>Remarks</span>
                                    </th>
                                </tr>

                                <tbody class="details_tbody">

                                    <tr t-foreach="line['records']" t-as="rec" class="border-black">

                                        <t t-set="worked_hours_total"
                                            t-value="worked_hours_total + rec['worked_hours']" />

                                        <td class="text-center">
                                            <t t-esc="rec['date']" />
                                        </td>
                                        <td class="text-center">
                                            <t t-esc="rec['day']"/>
                                        </td>

                                        <td class="text-center">
                                            <t t-if="rec['check_in']"
                                                t-esc="rec['check_in'].strftime('%H:%M:%S')" />
                                        </td>
                                        <td class="text-center">
                                            <t t-if="rec['check_out']"
                                                t-esc="rec['check_out'].strftime('%H:%M:%S')" />
                                        </td>
                                        <td class="text-center">
                                            <t t-esc="rec['worked_hours']"
                                                t-options='{"widget": "float", "precision": 2}' />
                                        </td>
                                        <td class="text-center">
                                            <t t-if="rec['remarks']=='Absent'">
                                                <span style="color:red;">
                                                    <t t-esc="rec['remarks']" />
                                                </span>
                                            </t>
                                            <t t-elif="rec['remarks']=='Present'">
                                                <span style="color:green;">
                                                    <t t-esc="rec['remarks']" />
                                                </span>
                                            </t>
                                            <t t-elif="rec['remarks']=='Weekend'">
                                                <span style="color:orange;">
                                                    <t t-esc="rec['remarks']" />
                                                </span>
                                            </t>
                                            <t t-else="">
                                                <t t-if="rec['remarks'] != False">
                                                    <span style="color:blue;">
                                                        <t t-esc="rec['remarks']" />
                                                    </span>
                                                </t>
                                                <t t-else="">
                                                    Present
                                                </t>                                                
                                            </t>
                                        </td>

                                    </tr>

                                </tbody>

                                <tr>
                                    <td colspan='4'>
                                        <strong>Total</strong>
                                    </td>
                                    <td class="text-center">
                                        <t t-esc="worked_hours_total"
                                            t-options='{"widget": "float", "precision": 2}' />
                                    </td>
                                    <td></td>
                                </tr>

                            </table>

                            <br />
                            <br />
                            <br />

                        </div>

                    </t>

                    <t t-set="counter" t-value="1" />
                </tr>

            </t>
        </t>

    </template>

</odoo>